(this.webpackJsonpreact_game_demo=this.webpackJsonpreact_game_demo||[]).push([[0],{20:function(e,t,n){},21:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),o=n.n(a),A=n(13),i=n.n(A),s=(n(20),n(2)),c=(n.p,n(21),n(12)),l=n(3),u=n(6),d=n(7),f=n(10),h=n(9),g=n(4),p=n(14),v={1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgBAMAAAB54XoeAAAAIVBMVEUAAAARcnr////V//ZK7dmh++ggxbUUXlMaqqcckZos4Nigq9g5AAAAAXRSTlMAQObYZgAAALNJREFUeAHt1UEJQ0EMhOFaqIVaWAuxsBZi4VlYC2uhKsvwIANl6bGX/P8pEPiu8yAiIvpPz0OAgIDf1ku5oW4VEBDQVlRTDZXqUoCAbUFbZmxNFcoqICBgeJp8RQUI2A88W1HNaqlUS1kFBOwIDmXLbQUICHiXajoVaqul2oKAgENFtQ5ltVUfEBDQXcpWHvLDVkcQEPCtfoNTtQUBAa1uFdWsUtnqCgICWj1nCxAQ0BHRB08RrgpIB5nAAAAAAElFTkSuQmCC",2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgBAMAAAB54XoeAAAAIVBMVEUAAAAALQAAUwAAexgAlSkAqiwX3WJB84SC9q2v/c3b/+vL/0L5AAAAAXRSTlMAQObYZgAAAJRJREFUeNrtzAEJwzAQQNFZqIVZiIVYiIWzUAuxUAtTOT6FHhyFQYEB5D8B7yVJ0n+8bxgaGtbrg/0SOFdDQ8O8DmQ4ENiwamhoWK+7sK6GhquGB+KS9UDHgGFlaDgx0GBoaGhoaPgknChhwLAyNNzR0LF2aGiY60BHQ14Tea0WGhr+XgN5GRoanrYiL0NDQ0mSHvgCKBcpgeyi22sAAAAASUVORK5CYII=",3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAAGFBMVEUAAAAuLS0ODg5/f39WVlY9PDyoqKgiICCZbn6HAAAAAXRSTlMAQObYZgAAAOBJREFUeF7t2rsOwjAMhlGScnn/N2azGayUKgsy59stnY5/lVunJEmSJOm1DBAQEBAQ8Iz1iEaUwBkBAgICAgJWrLp7BAgICAgI+MkaUYXJjqii9gQCAgICAu6znlGy8qInEBAQEBBwfxYlqzqoPjOpPYCAgICAgDVrFFWzqGIl5t+AgICAgIBj2VVWXfVLrjMQEBAQELAiXGflxRF1AQICAgICzujb+bRmJXqD9fNAQEBAQMA1dVxu48FyEyAgICAgYE09WR3LFqzmQEBAQEDAbG6UgAZAQEBAQMD9JEl6AxLtrp0NETMPAAAAAElFTkSuQmCC",4:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgBAMAAAB54XoeAAAAG1BMVEUAAACyZBH61kr99V91KAL//eDclhPpsRX////Pn3eMAAAAAXRSTlMAQObYZgAAAKVJREFUeAHtzEENwzAQBdFQKIWlYAqhEAqhYAqFXf3Lt7RSrLqXSuuZ+7yDiIjof70cICBgFkbhrAICbgkmoU2zCghYHkxCqPZloU4FCFgUtHWpttzlmjoVIGBhMNRcHUJibhVqCxAQcCxzoavb7QgCAoZ6q2fBdRWuOggI2NUA1xh3qJIgIGBWH8HuDGSmLAgIOFHXhfogIKBV9ygAAgL+HBER0QeimEC/ag4PiAAAAABJRU5ErkJggg==",5:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAAGFBMVEUAAAAcU6haguJ0l+oFJGMSQIs0XsMaPY+4dPlhAAAAAXRSTlMAQObYZgAAANhJREFUeF7t17kRwzAMRUFTl/vv2BngAINRokDkvgoW0R983p8kSZIkfW92RICAgICAgP+sEW1FVzSipK4GBAQEBARM1hUlZo8q1hlV1JmBgICAgIA9q6L2rOSvBgQEBAQE3KMK0w9cdchqQEBAQEDArSjRPWs1ICAgICBgsqoJq56mB1gvAQICAgIC9qz+VerfolG0BhAQEBAQ8Iz6WUvAVdSz5gMCAgICAh5Rheln7S5rDSAgICAg4IgqTEXIKtbMQEBAQEDAnvowAfDhAAEBAadMkiRJkn7jRqDxhV+9ZgAAAABJRU5ErkJggg==",6:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgBAMAAAB54XoeAAAAHlBMVEUAAABvXVqJe3OzoJG2pI7Uyrrd1Mbl39bq5d739fLt6B5KAAAAAXRSTlMAQObYZgAAAORJREFUeNrtzUGtLiEQROHfAhbaAhawgIWxgIWxgNuXs+lKCHnJ3U7XtyTF6d+fdMjvwsHaQQc73lQx6KCDHfL/1kagYtBBB98UuLbwIBx00MGNQMdOCxMOFg06eP/XsdKDgUBPXw866KAEVhroeKAj2m0UCzrooKoTaik4oMlCoETQQQd7CgwoKAMNEw2qlAg66OALVTsmHkwoqJvy9aCDDgY2XgQGFLy1VqoTdNDBiaM6k4LHeCLw9aCDDjZMSINaCg4cR5T6ZtBBB+UotHQLHq0SQQcdFGVub9dJuaCDDprZ3T/gfsulXSXlIQAAAABJRU5ErkJggg==",7:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAAGFBMVEUAAAA0BgVcBwByAABBBQCqDwH/AAAtAAAkyUUGAAAAAXRSTlMAQObYZgAAAMxJREFUeF7t2DEKAzEMRcHYu0nuf+N0UiOMzXbKvPZjmE7g178nSZIkSZIkzSJAQEBAQMB91hW9o1wBAQEBAQFrVmI+UQLv6Bt1BwICAgICPmddUa41tT8QEBAQELBmZbunbkYVtRsQEBAQELD+VluftcQktVqTP6Kk9gMCAgICAlaYBO6i10evHxAQEBAQMJ/c0Tkr14o6on5AQEBAQMA1dc2a0TmrGxAQEBAQsKZmI9rFVKzOQEBAQEDAc/QuBhAQEBAQ8HGSJEmS9AM5Npf107WbQgAAAABJRU5ErkJggg=="},b=Math.pow(8,2);function E(e){return[e%8,e/8|0]}var B=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).tnHandler=function(e){"transform"===e.propertyName&&r.props.onDestroyEnd()},r.state={on:!1},r.myRef=o.a.createRef(),r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=(t.id,t.index,t.dropHeight);n>0&&this.myRef.current.animate([{transform:"translateY(-".concat(100*n,"px)")},{transform:"translateY(0)"}],{duration:85*n,easing:"ease-in"}).finished.then((function(t){e.props.onFillEnd(e.props.index)}))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.myRef.current,r=this.props.index;if(this.props.tripled);else if(this.props.index!==e.index){var a=E(e.index),o=Object(s.a)(a,2),A=o[0],i=o[1],c=E(this.props.index),l=Object(s.a)(c,2),u=l[0],d=l[1];n.animate([{transform:"translate(".concat(100*(A-u),"px, ").concat(100*(i-d),"px)"),zIndex:e.on?2:1},{transform:"translate(0)",zIndex:e.on?2:1}],{duration:85*(Math.abs(A-u)+Math.abs(i-d)),easing:"ease-in"}).finished.then((function(e){t.props.onSwitchEnd(t.props.index)}))}else if(this.props.to>=0&&this.props.to!==e.to){var f=E(r),h=Object(s.a)(f,2),g=h[0],p=h[1],b=E(this.props.to),B=Object(s.a)(b,2),y=B[0],m=B[1];n.animate([{transform:"translate(0) scale(1)",opacity:1},{transform:"translate(".concat(60*(y-g),"px, ").concat(60*(m-p),"px)scale(.5)"),opacity:1},{transform:"translate(".concat(100*(y-g),"px, ").concat(100*(m-p),"px)scale(0)"),opacity:.1}],{duration:300,easing:"linear",fill:"forwards"})}else 8===this.props.type&&8!==e.type&&n.animate([{transform:"translateY(0) scale(1)",backgroundImage:"url(".concat(v[e.type],")"),zIndex:3},{transform:"translateY(50px) scale(0)",zIndex:3,offset:.8},{transform:"translateY(0) scale(1)",zIndex:3}],{duration:400,easing:"cubic-bezier(.175, .885, .32, 1.275)"}).finished.then((function(e){t.props.onDestroyEnd()}))}},{key:"render",value:function(){var e=["icon"];this.props.type&&e.push("t"+this.props.type),this.props.tripled&&e.push("tripled"),this.props.to>=0&&e.push("to");var t=["squares"],n=E(this.props.index),a=Object(s.a)(n,2),o=a[0],A=a[1];this.props.on&&t.push("on"),(o+A)%2===0&&t.push("dif");var i=Object(r.jsxs)("p",{className:"testfont",children:["index:",this.props.index," ",Object(r.jsx)("br",{}),"type:",this.props.type," ",Object(r.jsx)("br",{}),"id:",this.props.id]});return Object(r.jsxs)("div",{className:t.join(" "),onClick:this.props.onClick,children:[Object(r.jsx)("div",{ref:this.myRef,onTransitionEnd:this.tnHandler,className:e.join(" ")}),i]})}}]),n}(o.a.Component),y=new(function(){function e(){Object(u.a)(this,e),this.events={}}return Object(d.a)(e,[{key:"on",value:function(e,t){this.events[e]={once:!1,fn:t}}},{key:"off",value:function(e){delete this.events[e]}},{key:"once",value:function(e,t){this.events[e]={once:!0,fn:t}}},{key:"emit",value:function(e,t){var n=this;setTimeout((function(){if(e in n.events){var r=n.events[e],a=r.once,o=r.fn;a&&delete n.events[e],o(t)}else console.warn(e+" is no in events")}),0)}}]),e}()),m=0;function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return{type:Object(p.random)(1,7),id:++m,dropHeight:e,tripled:!1,to:t}}function I(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}var O=function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={boardArr:[],selectedIndex:null},r.status=0,r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){console.log("==\u5df2\u5f00\u542fDebug\u6a21\u5f0f=="),console.log("\u53ef\u5728js/config\u4e2d\u4fee\u6539"),this.resetBoard()}},{key:"resetBoard",value:function(){var e=this;this.setState({boardArr:new Array(b).fill(1).map((function(e){return Q(7)}))}),y.once("fillEnd",(function(t){console.log("reset fillEnd \u89e6\u53d1",t),e.digTriple()}))}},{key:"clickHandler",value:function(e){var t=this;if(this.state.boardArr[e].tripled)return!1;if(0!==this.status)return!1;var n=this.state.selectedIndex;if(this.state.boardArr[n]){if(e===n)return void this.setState({selectedIndex:null});var r=Math.abs(e-n);if(8===r||1===r){var a=Object(l.a)(this.state.boardArr);return I(a,n,e),this.setState({boardArr:a,selectedIndex:null}),y.once("switchEnd",(function(){var r=[e,n].find((function(e){return 8===a[e].type}));r>=0?t.dragonBreathBurst(r,a[e+n-r].type):t.digTriple([e,n],!0)})),void(this.status=1)}}this.setState({selectedIndex:e})}},{key:"switchEndHandler",value:function(e){y.emit("switchEnd",e)}},{key:"dragonBreathBurst",value:function(e,t){var n=this,r=[e],a=this.state.boardArr.map((function(e,n){return e.type===t&&(e.tripled=!0,r.push(n)),e}));a[e].tripled=!0,this.setState({boardArr:a,selectedIndex:null}),this.props.onScoreSubmit(15*r.length+50),y.once("destroyEnd",(function(){n.dropDown(r)}))}},{key:"checkGameAvailable",value:function(){console.log("%c* checkGameAvailable","color: red;");for(var e=this.state.boardArr,t=function(t){var n,r=e[t].type;if(8===r)return{v:!0};if(t%8!==7&&(null===(n=e[t+1])||void 0===n?void 0:n.type)===r){var a=[];if(t%8>0&&a.push(t-8-1,t+8-1),t%8<6&&a.push(t-8+2,t+8+2),t%8>1&&a.push(t-2),t%8<5&&a.push(t+3),a.some((function(t){var n;return t>=0&&(null===(n=e[t])||void 0===n?void 0:n.type)===r})))return{v:!0}}if(t<56&&(null===e||void 0===e?void 0:e[t+8].type)===r){var o=[];if(t%8>0&&o.push(t-8-1,t+16-1),t%8<7&&o.push(t-8+1,t+16+1),o.push(t-16,t+24),o.some((function(t){var n;return t>=0&&(null===(n=e[t])||void 0===n?void 0:n.type)===r})))return{v:!0}}else{var A=[t-8-1,t-8+1,t+8+1,t+8-1];t%8===0&&(A[0]=A[3]=-1),t%8===7&&(A[1]=A[2]=-1);for(var i=0;i<A.length;i++){var s,c,l=A[i],u=A[(i+1)%4];if((null===(s=e[l])||void 0===s?void 0:s.type)===r&&(null===(c=e[u])||void 0===c?void 0:c.type)===r)return{v:!0}}}},n=0;n<e.length;n++){var r=t(n);if("object"===typeof r)return r.v}return!1}},{key:"digTriple",value:function(e,t){var n=this;if(console.log("%c* digTriple","color: red;"),this.status=2,!e){e=[];for(var r=0;r<=b-1;r+=3)e.push(r)}var a=new Map,o=new Set;if(e.forEach((function(e){if(o.has(e))return!1;var t=function(e,t){var n=e[t].type,r=[];function a(t){for(var r=t,a=[],o=8*(t/8|0),A=o+8-1;r-1>=o&&(null===(i=e[r-1])||void 0===i?void 0:i.type)===n;){var i;r-=1}for(;r<=A&&(null===(s=e[r])||void 0===s?void 0:s.type)===n;){var s;a.push(r++)}return a}function o(t){for(var r=t,a=[];(null===(o=e[r-8])||void 0===o?void 0:o.type)===n;){var o;r-=8}for(;(null===(A=e[r])||void 0===A?void 0:A.type)===n;){var A;a.push(r),r+=8}return a}var A=a(t),i=o(t);return A.length>=3?(r=r.concat(A),A.forEach((function(e){var t=o(e);t.length>=3&&(r=r.concat(t))}))):i.length>=3&&(r=r.concat(i),i.forEach((function(e){var t=a(e);t.length>=3&&(r=r.concat(t))}))),r}(n.state.boardArr,e);if(t.length>=3){var r,A=t[t.length>>1],i=new Set,s=Object(g.a)(t);try{for(s.s();!(r=s.n()).done;){var c=r.value;i.has(c)?A=c:i.add(c)}}catch(l){s.e(l)}finally{s.f()}a.set(A,i),o.add(e),i.forEach((function(e){return o.add(e)}))}})),0===a.size){if(this.status=0,console.log("\u65e0\u4e09\u8fde"),t){var A=Object(l.a)(this.state.boardArr);I(A,e[0],e[1]),setTimeout((function(){n.setState({boardArr:A,selectedIndex:null})}),100)}else{this.checkGameAvailable()||(console.warn("\u5730\u56fe\u65e0\u6548\uff01"),setTimeout((function(){alert("\u5730\u56fe\u4e0d\u53ef\u7528\uff0c\u5373\u5c06\u5237\u65b0"),n.resetBoard()}),200))}return!1}var i,c=Object(l.a)(this.state.boardArr),u=[],d=Object(g.a)(a);try{var f=function(){var e=Object(s.a)(i.value,2),t=e[0],r=e[1];r.size<=4?(r.forEach((function(e){return c[e].tripled=!0})),u.push.apply(u,Object(l.a)(r)),n.props.onScoreSubmit(10*r.size)):(r.delete(t),c[t].type=8,r.forEach((function(e){return c[e].to=t})),u.push.apply(u,Object(l.a)(r)),n.props.onScoreSubmit(20*r.size))};for(d.s();!(i=d.n()).done;)f()}catch(h){d.e(h)}finally{d.f()}this.setState({boardArr:c,selectedIndex:null}),y.once("destroyEnd",(function(){n.dropDown(u)}))}},{key:"destroyEndHandler",value:function(e){y.emit("destroyEnd",e)}},{key:"dropDown",value:function(e){var t=this;console.log("%c* dropDown","color: red;",e),this.status=3;var n,r=new Set,a=[],o=Object(l.a)(this.state.boardArr),A=Object(g.a)(e);try{for(A.s();!(n=A.n()).done;){var i=n.value;r.add(56+i%8)}}catch(f){A.e(f)}finally{A.f()}r=Object(l.a)(r);var s,c=Object(g.a)(r);try{for(c.s();!(s=c.n()).done;){for(var u=s.value,d=[];u>=0;)if(o[u].tripled||o[u].to>=0)d.push(u),u-=8;else if(d.length>0){I(o,d.shift(),u)}else u-=8;a=a.concat(d)}}catch(f){c.e(f)}finally{c.f()}this.setState({boardArr:o}),setTimeout((function(){t.fillSquire(a)}),0)}},{key:"fillSquire",value:function(e){var t=this;console.log("%c* fillSquire","color: red;",e),this.status=4;var n,r={},a=0,o=0,A=Object(g.a)(e);try{for(A.s();!(n=A.n()).done;){var i=n.value%8;i in r?r[i]++:r[i]=1,r[i]>o&&(a=i,o=r[i])}}catch(f){A.e(f)}finally{A.f()}var s,c=Object(l.a)(this.state.boardArr),u=Object(g.a)(e);try{for(u.s();!(s=u.n()).done;){var d=s.value;c[d]=Q(r[d%8])}}catch(f){u.e(f)}finally{u.f()}this.setState({boardArr:c}),y.on("fillEnd",(function(e){e%8===a&&(y.off("fillEnd"),t.digTriple())}))}},{key:"fillEndHandler",value:function(e){y.emit("fillEnd",e)}},{key:"renderSquare",value:function(e,t){var n=this;return Object(a.createElement)(B,Object(c.a)(Object(c.a)({},e),{},{index:t,size:8,on:t===this.state.selectedIndex,onClick:function(){return n.clickHandler(t)},onSwitchEnd:function(){return n.switchEndHandler(t)},onDestroyEnd:function(e){return n.destroyEndHandler({e:e,index:t})},onFillEnd:function(){return n.fillEndHandler(t)},key:e.id}))}},{key:"render",value:function(){var e=this;return Object(r.jsx)("div",{className:"container",children:this.state.boardArr.map((function(t,n){return e.renderSquare(t,n)}))})}}]),n}(o.a.Component);function C(e){var t=e.score;return Object(r.jsxs)("div",{className:"panel",children:["\u5206\u6570\uff1a",Object(r.jsx)("i",{className:"scoreNum",children:t})]})}var j=function(){var e=Object(a.useState)(0),t=Object(s.a)(e,2),n=t[0],o=t[1];return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)(C,{score:n}),Object(r.jsx)(O,{onScoreSubmit:function(e){console.log("+"+e),o((function(t){return t+e}))}})]})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,25)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,A=t.getTTFB;n(e),r(e),a(e),o(e),A(e)}))};i.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(j,{})}),document.getElementById("root")),S()}},[[24,1,2]]]);
//# sourceMappingURL=main.8fab622e.chunk.js.map
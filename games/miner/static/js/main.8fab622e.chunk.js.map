{"version":3,"sources":["logo.svg","assets/js/config.js","assets/img/1.png","assets/img/2.png","assets/img/3.png","assets/img/4.png","assets/img/5.png","assets/img/6.png","assets/img/7.png","Square.js","assets/js/bus.js","Board.js","MessagePanel.js","App.js","reportWebVitals.js","index.js"],"names":["Icons","1","2","3","4","5","6","7","BoardSize","index2Coord","index","Square","props","tnHandler","e","propertyName","onDestroyEnd","state","on","myRef","React","createRef","this","dropHeight","id","current","animate","transform","duration","easing","finished","then","res","onFillEnd","prevProp","el","currIndex","tripled","x1","y1","x2","y2","zIndex","Math","abs","onSwitchEnd","to","opacity","fill","type","backgroundImage","offset","iconClass","push","squaresClass","x","y","debugTip","className","join","onClick","ref","onTransitionEnd","Component","events","key","fn","once","params","setTimeout","console","warn","idCounter","getNewItem","random","swap","arr","a","b","temp","Board","boardArr","selectedIndex","status","log","resetBoard","setState","Array","map","i","myEventBus","digTriple","sIndex","distance","newBoardArr","DBpos","find","dragonBreathBurst","emit","selfPos","targetType","needDestroyPosArr","item","onScoreSubmit","length","dropDown","target","BoardLen","pos","some","p","j","curr","next","posArr","isSwitch","needDestroyShape","Map","posTripled","Set","forEach","has","startPoint","findAtX","row","xMin","xMax","findAtY","col","firstXArr","firstYArr","concat","xi","YArr","yi","XArr","findTriple","core","posSet","add","set","size","checkGameAvailable","alert","delete","endPos","emptyArrTotal","epos","emptyArr","shift","fillSquire","dropCountPerCol","longestCol","longestColCount","off","clickHandler","switchEndHandler","destroyEndHandler","fillEndHandler","renderSquare","MessagePanel","score","App","useState","setScore","newScore","prev","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.8fab622e.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import img1 from '../img/1.png'\r\nimport img2 from '../img/2.png'\r\nimport img3 from '../img/3.png'\r\nimport img4 from '../img/4.png'\r\nimport img5 from '../img/5.png'\r\nimport img6 from '../img/6.png'\r\nimport img7 from '../img/7.png'\r\n\r\nconst Icons = {\r\n  1: img1,\r\n  2: img2,\r\n  3: img3,\r\n  4: img4,\r\n  5: img5,\r\n  6: img6,\r\n  7: img7,\r\n}\r\n\r\nconst BoardLen = 8\r\nconst BoardSize = BoardLen ** 2\r\n\r\nconst Debug = true\r\n\r\nexport { BoardLen, BoardSize, Debug, Icons }","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgBAMAAAB54XoeAAAAIVBMVEUAAAARcnr////V//ZK7dmh++ggxbUUXlMaqqcckZos4Nigq9g5AAAAAXRSTlMAQObYZgAAALNJREFUeAHt1UEJQ0EMhOFaqIVaWAuxsBZi4VlYC2uhKsvwIANl6bGX/P8pEPiu8yAiIvpPz0OAgIDf1ku5oW4VEBDQVlRTDZXqUoCAbUFbZmxNFcoqICBgeJp8RQUI2A88W1HNaqlUS1kFBOwIDmXLbQUICHiXajoVaqul2oKAgENFtQ5ltVUfEBDQXcpWHvLDVkcQEPCtfoNTtQUBAa1uFdWsUtnqCgICWj1nCxAQ0BHRB08RrgpIB5nAAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgBAMAAAB54XoeAAAAIVBMVEUAAAAALQAAUwAAexgAlSkAqiwX3WJB84SC9q2v/c3b/+vL/0L5AAAAAXRSTlMAQObYZgAAAJRJREFUeNrtzAEJwzAQQNFZqIVZiIVYiIWzUAuxUAtTOT6FHhyFQYEB5D8B7yVJ0n+8bxgaGtbrg/0SOFdDQ8O8DmQ4ENiwamhoWK+7sK6GhquGB+KS9UDHgGFlaDgx0GBoaGhoaPgknChhwLAyNNzR0LF2aGiY60BHQ14Tea0WGhr+XgN5GRoanrYiL0NDQ0mSHvgCKBcpgeyi22sAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAAGFBMVEUAAAAuLS0ODg5/f39WVlY9PDyoqKgiICCZbn6HAAAAAXRSTlMAQObYZgAAAOBJREFUeF7t2rsOwjAMhlGScnn/N2azGayUKgsy59stnY5/lVunJEmSJOm1DBAQEBAQ8Iz1iEaUwBkBAgICAgJWrLp7BAgICAgI+MkaUYXJjqii9gQCAgICAu6znlGy8qInEBAQEBBwfxYlqzqoPjOpPYCAgICAgDVrFFWzqGIl5t+AgICAgIBj2VVWXfVLrjMQEBAQELAiXGflxRF1AQICAgICzujb+bRmJXqD9fNAQEBAQMA1dVxu48FyEyAgICAgYE09WR3LFqzmQEBAQEDAbG6UgAZAQEBAQMD9JEl6AxLtrp0NETMPAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgBAMAAAB54XoeAAAAG1BMVEUAAACyZBH61kr99V91KAL//eDclhPpsRX////Pn3eMAAAAAXRSTlMAQObYZgAAAKVJREFUeAHtzEENwzAQBdFQKIWlYAqhEAqhYAqFXf3Lt7RSrLqXSuuZ+7yDiIjof70cICBgFkbhrAICbgkmoU2zCghYHkxCqPZloU4FCFgUtHWpttzlmjoVIGBhMNRcHUJibhVqCxAQcCxzoavb7QgCAoZ6q2fBdRWuOggI2NUA1xh3qJIgIGBWH8HuDGSmLAgIOFHXhfogIKBV9ygAAgL+HBER0QeimEC/ag4PiAAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAAGFBMVEUAAAAcU6haguJ0l+oFJGMSQIs0XsMaPY+4dPlhAAAAAXRSTlMAQObYZgAAANhJREFUeF7t17kRwzAMRUFTl/vv2BngAINRokDkvgoW0R983p8kSZIkfW92RICAgICAgP+sEW1FVzSipK4GBAQEBARM1hUlZo8q1hlV1JmBgICAgIA9q6L2rOSvBgQEBAQE3KMK0w9cdchqQEBAQEDArSjRPWs1ICAgICBgsqoJq56mB1gvAQICAgIC9qz+VerfolG0BhAQEBAQ8Iz6WUvAVdSz5gMCAgICAh5Rheln7S5rDSAgICAg4IgqTEXIKtbMQEBAQEDAnvowAfDhAAEBAadMkiRJkn7jRqDxhV+9ZgAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgBAMAAAB54XoeAAAAHlBMVEUAAABvXVqJe3OzoJG2pI7Uyrrd1Mbl39bq5d739fLt6B5KAAAAAXRSTlMAQObYZgAAAORJREFUeNrtzUGtLiEQROHfAhbaAhawgIWxgIWxgNuXs+lKCHnJ3U7XtyTF6d+fdMjvwsHaQQc73lQx6KCDHfL/1kagYtBBB98UuLbwIBx00MGNQMdOCxMOFg06eP/XsdKDgUBPXw866KAEVhroeKAj2m0UCzrooKoTaik4oMlCoETQQQd7CgwoKAMNEw2qlAg66OALVTsmHkwoqJvy9aCDDgY2XgQGFLy1VqoTdNDBiaM6k4LHeCLw9aCDDjZMSINaCg4cR5T6ZtBBB+UotHQLHq0SQQcdFGVub9dJuaCDDprZ3T/gfsulXSXlIQAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAMAAAC8EZcfAAAAGFBMVEUAAAA0BgVcBwByAABBBQCqDwH/AAAtAAAkyUUGAAAAAXRSTlMAQObYZgAAAMxJREFUeF7t2DEKAzEMRcHYu0nuf+N0UiOMzXbKvPZjmE7g178nSZIkSZIkzSJAQEBAQMB91hW9o1wBAQEBAQFrVmI+UQLv6Bt1BwICAgICPmddUa41tT8QEBAQELBmZbunbkYVtRsQEBAQELD+VluftcQktVqTP6Kk9gMCAgICAlaYBO6i10evHxAQEBAQMJ/c0Tkr14o6on5AQEBAQMA1dc2a0TmrGxAQEBAQsKZmI9rFVKzOQEBAQEDAc/QuBhAQEBAQ8HGSJEmS9AM5Npf107WbQgAAAABJRU5ErkJggg==\"","import React from 'react';\r\nimport { BoardLen, Debug, Icons } from './assets/js/config'\r\n\r\n// 下标转坐标\r\nfunction index2Coord(index) {\r\n  return [index % BoardLen, index / BoardLen | 0]\r\n}\r\n\r\nexport default class Square extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n\r\n      on: false,\r\n      // style: {}\r\n    }\r\n    this.myRef = React.createRef();\r\n  }\r\n\r\n  componentDidMount() {\r\n    let { id, index, dropHeight } = this.props\r\n    if (dropHeight > 0) {\r\n      let el = this.myRef.current\r\n      // let Y = index / 7 | 0\r\n      el.animate(\r\n        [\r\n          { transform: `translateY(-${dropHeight * 100}px)` },\r\n          { transform: `translateY(0)` }\r\n        ],\r\n        {\r\n          duration: 85 * dropHeight,\r\n          easing: 'ease-in'\r\n        }\r\n      )\r\n        .finished.then(res => {\r\n          this.props.onFillEnd(this.props.index)\r\n        });\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProp) {\r\n    let el = this.myRef.current,\r\n      currIndex = this.props.index\r\n\r\n    if (this.props.tripled) {\r\n      // el.animate(\r\n      //   [\r\n      //     { transform: `rotate(-90deg) scale()` },\r\n      //     { transform: `translate(0)` }\r\n      //   ],\r\n      //   {\r\n      //     duration: (Math.abs(x1 - x2) + Math.abs(y1 - y2)) * 85,\r\n      //     easing: 'ease-in'\r\n      //   }\r\n      // );\r\n    }\r\n    else if (this.props.index !== prevProp.index) {\r\n      // switch & drop animation\r\n      let [x1, y1] = index2Coord(prevProp.index),\r\n        [x2, y2] = index2Coord(this.props.index)\r\n      el.animate(\r\n        [\r\n          { transform: `translate(${(x1 - x2) * 100}px, ${(y1 - y2) * 100}px)`, zIndex: prevProp.on ? 2 : 1 },\r\n          { transform: `translate(0)`, zIndex: prevProp.on ? 2 : 1 }\r\n        ],\r\n        {\r\n          duration: (Math.abs(x1 - x2) + Math.abs(y1 - y2)) * 85,\r\n          easing: 'ease-in'\r\n        }\r\n      )\r\n        .finished.then(res => {\r\n          this.props.onSwitchEnd(this.props.index)\r\n        })\r\n      // console.log(x1 - x2, y1 - y2, (Math.abs(x1 - x2) + Math.abs(y1 - y2)) * 100);\r\n    } else if (this.props.to >= 0 && this.props.to !== prevProp.to) {\r\n      // fly to core animtion\r\n      let [x1, y1] = index2Coord(currIndex),\r\n        [x2, y2] = index2Coord(this.props.to)\r\n      el.animate([\r\n        { transform: `translate(0) scale(1)`, opacity: 1 },\r\n        { transform: `translate(${(x2 - x1) * 60}px, ${(y2 - y1) * 60}px)scale(.5)`, opacity: 1 },\r\n        { transform: `translate(${(x2 - x1) * 100}px, ${(y2 - y1) * 100}px)scale(0)`, opacity: .1 }\r\n      ],\r\n        {\r\n          duration: 300,\r\n          easing: 'linear',\r\n          fill: 'forwards'\r\n        })\r\n    } else if (this.props.type === 8 && prevProp.type !== 8) {\r\n      el.animate([\r\n        {\r\n          transform: `translateY(0) scale(1)`,\r\n          backgroundImage: `url(${Icons[prevProp.type]})`,\r\n          zIndex: 3\r\n        },\r\n        {\r\n          transform: `translateY(50px) scale(0)`,\r\n          zIndex: 3,\r\n          offset: 0.8,\r\n        },\r\n        {\r\n          transform: `translateY(0) scale(1)`,\r\n          zIndex: 3\r\n        },\r\n      ],\r\n        {\r\n          duration: 400,\r\n          easing: `cubic-bezier(.175, .885, .32, 1.275)`\r\n        }).finished.then(res => {\r\n          this.props.onDestroyEnd()\r\n        })\r\n    }\r\n  }\r\n\r\n  tnHandler = (e) => {\r\n    if (e.propertyName === 'transform') {\r\n      this.props.onDestroyEnd()\r\n    }\r\n  }\r\n  render() {\r\n    let iconClass = ['icon']\r\n    if (this.props.type) iconClass.push('t' + this.props.type)\r\n    if (this.props.tripled) iconClass.push('tripled')\r\n    if (this.props.to >= 0) iconClass.push('to')\r\n\r\n    let squaresClass = ['squares']\r\n    let [x, y] = index2Coord(this.props.index)\r\n    if (this.props.on) squaresClass.push('on')\r\n    if ((x + y) % 2 === 0) squaresClass.push('dif')\r\n\r\n    let debugTip =\r\n      <p className=\"testfont\">\r\n        index:{this.props.index} <br />\r\n        type:{this.props.type} <br />\r\n        id:{this.props.id}\r\n      </p>\r\n\r\n    return <div\r\n      className={squaresClass.join(' ')}\r\n      onClick={this.props.onClick}\r\n    >\r\n      <div\r\n        ref={this.myRef}\r\n        onTransitionEnd={this.tnHandler}\r\n        className={iconClass.join(' ')}></div>\r\n      {Debug ? debugTip : null}\r\n    </div>\r\n  }\r\n}","import { Debug } from './config'\r\n\r\nclass EventBus {\r\n  constructor() {\r\n    this.events = {\r\n      /* [eventName]: {\r\n        isOnce: false,\r\n        fn: fn\r\n      }\r\n      */\r\n    }\r\n  }\r\n\r\n  on(key, fn) {\r\n    this.events[key] = {\r\n      once: false,\r\n      fn\r\n    }\r\n  }\r\n  off(key) {\r\n    delete this.events[key]\r\n  }\r\n  once(key, fn) {\r\n    this.events[key] = {\r\n      once: true,\r\n      fn\r\n    }\r\n  }\r\n  emit(key, params) {\r\n    setTimeout(() => {\r\n      if (key in this.events) {\r\n        let { once, fn } = this.events[key]\r\n        // if (key in this.events) {\r\n        if (once) delete this.events[key]\r\n        fn(params)\r\n        // }\r\n      } else {\r\n        Debug && console.warn(key + ' is no in events')\r\n      }\r\n    }, 0);\r\n  }\r\n}\r\n\r\nexport default new EventBus()","import { random } from 'lodash';\r\n\r\nimport React from 'react';\r\nimport Square from './Square'\r\nimport myEventBus from './assets/js/bus.js'\r\n\r\nimport { BoardLen, BoardSize, Debug } from './assets/js/config'\r\n\r\nlet idCounter = 0\r\n\r\nfunction getNewBoard() {\r\n  return new Array(BoardSize).fill(1).map(i => {\r\n    return getNewItem(7)\r\n  })\r\n}\r\n\r\nfunction getNewItem(dropHeight = 0, to) {\r\n  return {\r\n    type: random(1, 7),\r\n    id: ++idCounter,\r\n    dropHeight,\r\n    tripled: false,\r\n    to\r\n  }\r\n}\r\n\r\n// get Manhattan Distance\r\nfunction getManDis(p1, p2) {\r\n  let [x1, y1] = [p1 % BoardLen, p1 / BoardLen | 0]\r\n  let [x2, y2] = [p2 % BoardLen, p2 / BoardLen | 0]\r\n\r\n  return Math.abs(x1 - x2) + Math.abs(y1 - y2)\r\n}\r\n\r\n// 下标转坐标\r\nfunction index2Coord(index) {\r\n  return [index % BoardLen, index / BoardLen | 0]\r\n}\r\n\r\n// 获得形状的交点\r\nfunction getShapeCenter(arr) {\r\n  for (let i of arr) {\r\n    let x1 = i % BoardLen, y1 = i / BoardLen | 0, ji = 0\r\n    for (; ji < arr.length; ji++) {\r\n      let j = arr[ji]\r\n      if (i === j) continue\r\n      let x2 = j % BoardLen, y2 = j / BoardLen | 0\r\n      if (Math.abs(x2 - x1) === 0 || Math.abs(y2 - y1) === 0) continue\r\n      else break\r\n    }\r\n    if (ji === arr.length) return i\r\n  }\r\n  return false\r\n}\r\n\r\nfunction swap(arr, a, b) {\r\n  let temp = arr[a]\r\n  arr[a] = arr[b]\r\n  arr[b] = temp\r\n}\r\n\r\nfunction findTriple(arr, startPoint) {\r\n  let target = arr[startPoint].type,\r\n    res = []\r\n\r\n  function findAtX(pos) {\r\n    let x = pos, row = [],\r\n      xMin = (pos / BoardLen | 0) * BoardLen,\r\n      xMax = xMin + BoardLen - 1\r\n    while ((x - 1) >= xMin && arr[x - 1]?.type === target) {\r\n      x -= 1\r\n    }\r\n    while (x <= xMax && arr[x]?.type === target) {\r\n      row.push(x++)\r\n    }\r\n    return row\r\n  }\r\n\r\n  function findAtY(pos) {\r\n    let y = pos, col = []\r\n    while (arr[y - BoardLen]?.type === target) {\r\n      y -= BoardLen\r\n    }\r\n    while (arr[y]?.type === target) {\r\n      col.push(y)\r\n      y += BoardLen\r\n    }\r\n    return col\r\n  }\r\n\r\n  let firstXArr = findAtX(startPoint),\r\n    firstYArr = findAtY(startPoint)\r\n\r\n  if (firstXArr.length >= 3) {\r\n    res = res.concat(firstXArr)\r\n    firstXArr.forEach(xi => {\r\n      let YArr = findAtY(xi)\r\n      if (YArr.length >= 3) res = res.concat(YArr)\r\n    })\r\n  } else if (firstYArr.length >= 3) {\r\n    res = res.concat(firstYArr)\r\n    firstYArr.forEach(yi => {\r\n      let XArr = findAtX(yi)\r\n      if (XArr.length >= 3) res = res.concat(XArr)\r\n    })\r\n  }\r\n  return res\r\n}\r\n\r\n// console.log(boardArr)\r\n\r\nexport default class Board extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      boardArr: [],\r\n      selectedIndex: null,\r\n    };\r\n\r\n    // this.stateData = null\r\n    this.status = 0\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (Debug) {\r\n      console.log('==已开启Debug模式==')\r\n      console.log('可在js/config中修改')\r\n    }\r\n    this.resetBoard()\r\n  }\r\n\r\n  resetBoard() {\r\n    this.setState({\r\n      boardArr: getNewBoard()\r\n    })\r\n    myEventBus.once('fillEnd', (index) => {\r\n      console.log('reset fillEnd 触发', index);\r\n      this.digTriple()\r\n    })\r\n  }\r\n\r\n  clickHandler(index) {\r\n    // 空格不处理\r\n    if (this.state.boardArr[index].tripled) return false\r\n    // 不在空闲状态不处理\r\n    if (this.status !== 0) return false\r\n\r\n    let sIndex = this.state.selectedIndex\r\n\r\n    if (this.state.boardArr[sIndex]) {\r\n      if (index === sIndex) {\r\n        // 取消选择\r\n        this.setState({ selectedIndex: null })\r\n        return\r\n      }\r\n      let distance = Math.abs(index - sIndex)\r\n      if (distance === BoardLen || distance === 1) {\r\n        // if (true) {\r\n        // 是上下左右的相邻格子，可以交换\r\n        let newBoardArr = [...this.state.boardArr]\r\n        swap(newBoardArr, sIndex, index)\r\n\r\n\r\n\r\n        this.setState({\r\n          boardArr: newBoardArr,\r\n          selectedIndex: null\r\n        });\r\n\r\n        myEventBus.once('switchEnd', () => {\r\n          let DBpos = [index, sIndex].find(i => newBoardArr[i].type === 8)\r\n          if (DBpos >= 0) {\r\n            this.dragonBreathBurst(DBpos, newBoardArr[index + sIndex - DBpos].type)\r\n          } else {\r\n            this.digTriple([index, sIndex], true)\r\n          }\r\n        })\r\n\r\n        this.status = 1\r\n        return\r\n      }\r\n    }\r\n\r\n    // 选中格子\r\n    this.setState({ selectedIndex: index })\r\n  }\r\n\r\n  // when switch animation end -> digTriple\r\n  switchEndHandler(index) {\r\n    myEventBus.emit('switchEnd', index)\r\n  }\r\n\r\n  // 龙息瓶爆炸！！\r\n  dragonBreathBurst(selfPos, targetType) {\r\n    let needDestroyPosArr = [selfPos]\r\n    let newBoardArr = this.state.boardArr.map((item, index) => {\r\n      if (item.type === targetType) {\r\n        item.tripled = true\r\n        needDestroyPosArr.push(index)\r\n      }\r\n      return item\r\n    })\r\n    newBoardArr[selfPos].tripled = true\r\n    this.setState({\r\n      boardArr: newBoardArr,\r\n      selectedIndex: null\r\n    });\r\n    // 提交分数\r\n    this.props.onScoreSubmit(needDestroyPosArr.length * 15 + 50)\r\n\r\n    myEventBus.once('destroyEnd', () => {\r\n      this.dropDown(needDestroyPosArr)\r\n    })\r\n  }\r\n\r\n  // 检查地图是否有效\r\n  checkGameAvailable() {\r\n    Debug && console.log('%c* checkGameAvailable', 'color: red;');\r\n    let { boardArr } = this.state\r\n    // console.clear()\r\n    for (let i = 0; i < boardArr.length; i++) {\r\n      // console.log(i);\r\n      let target = boardArr[i].type\r\n      if (target === 8) return true\r\n      /*\r\n      情况1\r\n        ■    ■\r\n      ■   ■■  ■\r\n        ■    ■\r\n      */\r\n      if (\r\n        i % BoardLen !== BoardLen - 1        //不在最后一列\r\n        && boardArr[i + 1]?.type === target   //右侧相等\r\n      ) {\r\n        let pos = []\r\n        if (i % BoardLen > 0) {\r\n          pos.push(\r\n            i - BoardLen - 1,  //左上\r\n            i + BoardLen - 1   //左下\r\n          )\r\n        }\r\n        if (i % BoardLen < BoardLen - 2) {\r\n          pos.push(\r\n            i - BoardLen + 2,  //右上\r\n            i + BoardLen + 2   //右下\r\n          )\r\n        }\r\n        if (i % BoardLen > 1) {\r\n          pos.push(\r\n            i - 2               //左2\r\n          )\r\n        }\r\n        if (i % BoardLen < BoardLen - 3) {\r\n          pos.push(\r\n            i + 3,              //右3\r\n          )\r\n        }\r\n\r\n        if (\r\n          pos.some(p => p >= 0 && boardArr[p]?.type === target)\r\n        )\r\n          return true\r\n      }\r\n      /*\r\n      情况2\r\n        ■\r\n      ■  ■\r\n        ■\r\n        ■\r\n      ■  ■\r\n        ■\r\n      */\r\n      if (\r\n        i < BoardLen * (BoardLen - 1)                //不在最后一行\r\n        && boardArr?.[i + BoardLen].type === target   //下侧相等\r\n      ) {\r\n        let pos = []\r\n        if (i % BoardLen > 0) {\r\n          pos.push(\r\n            i - BoardLen - 1,      //左上\r\n            i + BoardLen * 2 - 1   //左下\r\n          )\r\n        }\r\n        if (i % BoardLen < BoardLen - 1) {\r\n          pos.push(\r\n            i - BoardLen + 1,      //右上\r\n            i + BoardLen * 2 + 1   //右下\r\n          )\r\n        }\r\n        pos.push(\r\n          i - BoardLen * 2,        //上2\r\n          i + BoardLen * 3         //下3\r\n        )\r\n\r\n        if (\r\n          pos.some(p => p >= 0 && boardArr[p]?.type === target)\r\n        )\r\n          return true\r\n      }\r\n      /*\r\n      情况3\r\n      ■  ■\r\n        ■\r\n      ■  ■\r\n      */\r\n      else {\r\n        let pos = [\r\n          i - BoardLen - 1, //左上\r\n          i - BoardLen + 1, //右上\r\n          i + BoardLen + 1, //右下\r\n          i + BoardLen - 1, //左下\r\n        ]\r\n        if (i % BoardLen === 0) {\r\n          pos[0] = pos[3] = -1\r\n        }\r\n        if (i % BoardLen === BoardLen - 1) {\r\n          pos[1] = pos[2] = -1\r\n        }\r\n        for (let j = 0; j < pos.length; j++) {\r\n          let curr = pos[j], next = pos[(j + 1) % 4]\r\n          if (\r\n            boardArr[curr]?.type === target\r\n            && boardArr[next]?.type === target\r\n          )\r\n            return true\r\n        }\r\n      }\r\n    }\r\n    return false\r\n  }\r\n\r\n\r\n  // 寻找并消灭三连！\r\n  digTriple(posArr, isSwitch) {\r\n    Debug && console.log('%c* digTriple', 'color: red;');\r\n    this.status = 2\r\n    if (!posArr) {\r\n      // 不传表示全盘检查，仅需每3个格子检查一次\r\n      posArr = []\r\n      for (let i = 0; i <= BoardSize - 1; i += 3) {\r\n        posArr.push(i)\r\n      }\r\n    }\r\n    // console.log('posArr.length', posArr.length);\r\n\r\n    let needDestroyShape = new Map(),\r\n      posTripled = new Set()\r\n\r\n    posArr.forEach(i => {\r\n      if (posTripled.has(i)) {\r\n        return false\r\n      }\r\n      // 以该点为起点寻找三连\r\n      let pos = findTriple(this.state.boardArr, i)\r\n      // console.log(pos);\r\n      if (pos.length >= 3) {\r\n        // console.log('destroyed', pos);\r\n        let core = pos[pos.length >> 1], posSet = new Set()\r\n\r\n        // 一字型，core设为中间\r\n        // if (pos.length >= 5) {\r\n        //   let sort = pos.sort(),\r\n        //     dis = sort[1] - sort[0],\r\n        //     res = true\r\n\r\n        //   for (let p = 2; p < sort.length; p++) {\r\n        //     if (pos[p] - pos[p - 1] !== dis) {\r\n        //       res = false\r\n        //       break\r\n        //      }\r\n        //   }\r\n        //   if (res)\r\n        // }\r\n\r\n        for (let p of pos) {\r\n          if (posSet.has(p)) core = p\r\n          else posSet.add(p)\r\n        }\r\n        // needDestroyShape = needDestroyShape.concat([...posSet])\r\n        needDestroyShape.set(core, posSet)\r\n        posTripled.add(i)\r\n        posSet.forEach(i => posTripled.add(i))\r\n      }\r\n    })\r\n\r\n    if (needDestroyShape.size === 0) {\r\n      this.status = 0\r\n      console.log('无三连');\r\n      if (isSwitch) {\r\n        // this.checkGameAvailable()\r\n        // 回到交换前位置\r\n        let newBoardArr = [...this.state.boardArr]\r\n        swap(newBoardArr, posArr[0], posArr[1])\r\n        setTimeout(() => {\r\n          this.setState({\r\n            boardArr: newBoardArr,\r\n            selectedIndex: null\r\n          });\r\n        }, 100);\r\n      } else {\r\n        let able = this.checkGameAvailable()\r\n        // if (true) {\r\n        if (!able) {\r\n          console.warn('地图无效！')\r\n          setTimeout(() => {\r\n            alert('地图不可用，即将刷新')\r\n            this.resetBoard()\r\n          }, 200);\r\n        }\r\n      }\r\n      return false\r\n    }\r\n\r\n    let newBoardArr = [...this.state.boardArr],\r\n      needDestroyPosArr = []\r\n\r\n    for (let [core, posSet] of needDestroyShape) {\r\n      // console.log(posSet);\r\n      if (posSet.size <= 4) {\r\n        // 正常消除\r\n        posSet.forEach(i => newBoardArr[i].tripled = true)\r\n\r\n        needDestroyPosArr.push(...posSet)\r\n\r\n        // 提交分数\r\n        this.props.onScoreSubmit(posSet.size * 10)\r\n      } else {\r\n        // 飞向核心并生成龙息瓶\r\n        posSet.delete(core)\r\n        newBoardArr[core].type = 8\r\n\r\n        posSet.forEach(i => newBoardArr[i].to = core)\r\n        needDestroyPosArr.push(...posSet)\r\n\r\n        // 提交分数\r\n        this.props.onScoreSubmit(posSet.size * 20)\r\n      }\r\n    }\r\n    // needDestroyShape.forEach(j => newBoardArr[j].tripled = true)\r\n    this.setState({\r\n      boardArr: newBoardArr,\r\n      selectedIndex: null\r\n    });\r\n    myEventBus.once('destroyEnd', () => {\r\n      this.dropDown(needDestroyPosArr)\r\n    })\r\n  }\r\n\r\n  destroyEndHandler(index) {\r\n    myEventBus.emit('destroyEnd', index)\r\n  }\r\n\r\n  // 下落\r\n  dropDown(posArr) {\r\n    Debug && console.log('%c* dropDown', 'color: red;', posArr);\r\n    this.status = 3\r\n\r\n    let endPos = new Set(),\r\n      emptyArrTotal = [],\r\n      newBoardArr = [...this.state.boardArr]\r\n    for (let pos of posArr) {\r\n      endPos.add(56 + pos % BoardLen)\r\n    }\r\n    // 得到底部坐标\r\n    endPos = [...endPos]\r\n    // 自底部向上遍历\r\n    for (let epos of endPos) {\r\n      let emptyArr = []\r\n      while (epos >= 0) {\r\n        if (newBoardArr[epos].tripled || newBoardArr[epos].to >= 0) {\r\n          emptyArr.push(epos)\r\n          epos -= BoardLen\r\n        }\r\n        else if (emptyArr.length > 0) {\r\n          let pos = emptyArr.shift()\r\n          swap(newBoardArr, pos, epos)\r\n        } else {\r\n          epos -= BoardLen\r\n        }\r\n      }\r\n      emptyArrTotal = emptyArrTotal.concat(emptyArr)\r\n    }\r\n    // console.log(endPos);\r\n    this.setState({\r\n      boardArr: newBoardArr\r\n    })\r\n\r\n    setTimeout(() => {\r\n      this.fillSquire(emptyArrTotal)\r\n    }, 0);\r\n  }\r\n\r\n  fillSquire(posArr) {\r\n    Debug && console.log('%c* fillSquire', 'color: red;', posArr);\r\n    this.status = 4\r\n\r\n    let dropCountPerCol = {},\r\n      longestCol = 0,\r\n      longestColCount = 0\r\n    for (let pos of posArr) {\r\n      let col = pos % BoardLen\r\n      if (col in dropCountPerCol) dropCountPerCol[col]++\r\n      else dropCountPerCol[col] = 1\r\n      if (dropCountPerCol[col] > longestColCount) {\r\n        longestCol = col\r\n        longestColCount = dropCountPerCol[col]\r\n      }\r\n    }\r\n    let newBoardArr = [...this.state.boardArr]\r\n    for (let pos of posArr) {\r\n      newBoardArr[pos] = getNewItem(dropCountPerCol[pos % BoardLen])\r\n    }\r\n    this.setState({\r\n      boardArr: newBoardArr\r\n    })\r\n\r\n\r\n    myEventBus.on('fillEnd', (index) => {\r\n      if (index % BoardLen === longestCol) {\r\n        // 需等到最后一个掉落再触发\r\n        myEventBus.off('fillEnd')\r\n        // console.log(myEventBus.fillEnd);\r\n        // 全部检查\r\n        this.digTriple()\r\n      }\r\n    })\r\n  }\r\n\r\n  fillEndHandler(index) {\r\n    myEventBus.emit('fillEnd', index)\r\n  }\r\n\r\n  renderSquare(i, index) {\r\n    return <Square\r\n      {...i}\r\n      index={index}\r\n      size={BoardLen}\r\n      on={index === this.state.selectedIndex}\r\n      onClick={() => this.clickHandler(index)}\r\n      onSwitchEnd={() => this.switchEndHandler(index)}\r\n      onDestroyEnd={(e) => this.destroyEndHandler({ e, index })}\r\n      onFillEnd={() => this.fillEndHandler(index)}\r\n\r\n      key={i.id}\r\n    />;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"container\">\r\n        {\r\n          this.state.boardArr.map((item, index) => this.renderSquare(item, index))\r\n        }\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import React from 'react';\r\n\r\nexport default function MessagePanel(props) {\r\n  let { score } = props\r\n  // const [count, setCount] = useState(0);\r\n  return (\r\n    <div className=\"panel\">\r\n      分数：<i className=\"scoreNum\">{score}</i>\r\n    </div>\r\n  )\r\n}","import logo from './logo.svg';\nimport './assets/css/App.css';\n\nimport Board from './Board'\nimport MessagePanel from './MessagePanel'\n\nimport { useState } from 'react';\nfunction App() {\n  let [score, setScore] = useState(0)\n  function ScoreHandler(newScore) {\n    console.log('+' + newScore);\n    setScore(prev => prev + newScore)\n  }\n  return (\n    <div className=\"App\">\n      <MessagePanel score={score}></MessagePanel>\n      <Board onScoreSubmit={ScoreHandler}></Board>\n      {/* <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          Edit <code>src/App.js</code> and save to reload.\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n      </header> */}\n    </div >\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './assets/css/index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}